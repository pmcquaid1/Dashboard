{% extends 'base.html' %}
{% load static %}

{% block content %}
    {% if messages %}
    <div class="container mt-3">
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        {% endfor %}
    </div>
    {% endif %}

<div class="form-container">
  <h2 class="mb-4 text-center">Fuel Request Form</h2>

  <form method="post">
    {% csrf_token %}

    <div class="row">
      <div class="col-12 col-md-6 mb-3 form-group">
        <label for="{{ form.date.id_for_label }}">Date</label>
        {{ form.date }}
      </div>

      <div class="col-12 col-md-6 mb-3 form-group">
        <label for="{{ form.vendor.id_for_label }}">Vendor</label>
        {{ form.vendor }}
      </div>

      <div class="col-12 col-md-6 mb-3 form-group">
        <label for="{{ form.po_number.id_for_label }}">PO Number</label>
        {{ form.po_number }}
      </div>

      <div class="col-12 col-md-6 mb-3 form-group">
        <label for="{{ form.driver_name.id_for_label }}">Driver Name</label>
        {{ form.driver_name }}
      </div>

      <div class="col-12 col-md-6 mb-3 form-group">
        <label for="{{ form.driver_phone.id_for_label }}">Driver Phone (WhatsApp)</label>
        {{ form.driver_phone }}
      </div>

      <div class="col-12 col-md-6 mb-3 form-group">
        <label for="{{ form.vehicle_number.id_for_label }}">Vehicle Number</label>
        {{ form.vehicle_number }}
      </div>

      <div class="col-12 col-md-6 mb-3 form-group">
        <label for="{{ form.place_of_loading.id_for_label }}">Place of Loading</label>
        {{ form.place_of_loading }}
      </div>

      <div class="col-12 col-md-6 mb-3 form-group">
        <label for="{{ form.destination.id_for_label }}">Destination</label>
        {{ form.destination }}
      </div>

      <div class="col-12 col-md-6 mb-3 form-group">
        <label for="{{ form.fuel_quantity.id_for_label }}">Fuel Quantity</label>
        {{ form.fuel_quantity }}
      </div>

      <div class="col-12 col-md-6 mb-3 form-group">
        <label for="{{ form.initial_tank_amount.id_for_label }}">Initial Tank Amount</label>
        {{ form.initial_tank_amount }}
      </div>

      <div class="col-12 col-md-6 mb-3 form-group">
        <label for="{{ form.top_up_quantity.id_for_label }}">Top-Up Quantity</label>
        {{ form.top_up_quantity }}
      </div>

      <div class="col-12 col-md-6 mb-3 form-group">
        <label for="{{ form.authorized_by.id_for_label }}">Authorized By</label>
        {{ form.authorized_by }}
      </div>
    </div>

    <div class="text-center">
      <button type="submit" class="btn btn-primary">Submit</button>
    </div>
  </form>
</div>

<script src="{% static 'js/jquery.min.js' %}"></script>
<script src="{% static 'js/jquery-ui/jquery-ui.min.js' %}"></script>
<link rel="stylesheet" href="{% static 'js/jquery-ui/jquery-ui.min.css' %}">
<script src="{% static 'js/signature_pad.umd.min.js' %}"></script>
<script>
  // Auto-dismiss alerts after 4 seconds
  setTimeout(function () {
    const alerts = document.querySelectorAll('.alert');
    alerts.forEach(function (alert) {
      alert.classList.remove('show');
      alert.classList.add('fade');
      setTimeout(() => alert.remove(), 500); // remove from DOM after fade
    });
  }, 4000); // 4000ms = 4 seconds
</script>

<script>
  const canvas = document.getElementById('signature_pad');
  const signaturePad = new SignaturePad(canvas);

  document.querySelector('form').addEventListener('submit', function () {
    document.getElementById('id_signature').value = signaturePad.toDataURL();
    signaturePad.clear();
  });

  document.getElementById('clear').addEventListener('click', function () {
    signaturePad.clear();
  });

</script>
{% endblock %}






